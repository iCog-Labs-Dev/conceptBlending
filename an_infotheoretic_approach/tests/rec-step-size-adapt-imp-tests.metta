! (register-module! ../../an_infotheoretic_approach)
! (import! &self an_infotheoretic_approach:rec-step-size-adapt-imp)

; Test y (mean-diff-step)
! (assertEqual
    (mean-diff-step (mean) (old_mean) (step_size) )
    (-0.19960242556197227 0.17335879032213014 0.040748194300876485 0.014420968325299417 0.014753270835294967 0.02722716524905113 -0.21532119599618724 -0.02000377024487971)
)

; Test matrix inverse transpose
! (assertEqual
    (inverse-transpose ((0.35707521644605916 0 0 0 0 0 0 0) (-0.02064500351878554 0.35103328293725844 0 0 0 0 0 0) (0.02208328536066628 0.037842246446903385 0.3605796361298447 0 0 0 0 0) (-0.01704205086134636 0.0019318359054898756 -0.004804719580737934 0.330273729930529 0 0 0 0) (-0.02108689613057322 0.0016608740068908409 -0.021078956760960426 -0.017909695905700046 0.34387631175110994 0 0 0) (0.001721163137887059 0.010569424893254993 0.011566120390002804 0.0033702414678046903 -0.009384537210246166 0.3418301188423875 0 0) (0.001829470290606638 -0.006869042044209485 0.00854934349729806 -0.007572019774697034 -0.01335108732232222 -0.01738238804073887 0.3263989204875843 0) (-0.0010915722571826273 -0.012267484373725967 -0.012324899373403472 -0.007115252094033822 0.005058934254556774 -0.011723249082197826 -0.008911007688015681 0.3257484811896604)))
    ((2.800530403518114 0.16470506600204976 -0.1888007944417046 0.1407967371520952 0.16669610662946413 -0.009617256668958747 0.0022871422544457594 0.00864680073304392) (0 2.848732723098322 -0.29896986675649434 -0.02101211783916498 -0.03317960347223877 -0.07867096231738079 0.06174800993278326 0.09488398887002662) (0 0 2.773312466375389 0.04034528787227877 0.17209997716624853 -0.08951042901494531 -0.06943248689811135 0.0980178170208294) (0 0 0 3.0277915237471165 0.15769282036331483 -0.025522954028327223 0.07533179943931859 0.06482858366200249) (0 0 0 0 2.9080223493957265 0.07983627668197041 0.12320201734426509 -0.038918674767117606) (0 0 0 0 0 2.9254297526107824 0.15579388274275136 0.10954409370958469) (0 0 0 0 0 0 3.0637356229799124 0.08380997385073326) (0 0 0 0 0 0 0 3.06985314666063))
)

; Test new p-sigma
! (assertEqual
    (new-p-sigma (c_sigma) (p_sigma) (mu_eff) ((2.800530403518114 0.16470506600204976 -0.1888007944417046 0.1407967371520952 0.16669610662946413 -0.009617256668958747 0.0022871422544457594 0.00864680073304392) (0 2.848732723098322 -0.29896986675649434 -0.02101211783916498 -0.03317960347223877 -0.07867096231738079 0.06174800993278326 0.09488398887002662) (0 0 2.773312466375389 0.04034528787227877 0.17209997716624853 -0.08951042901494531 -0.06943248689811135 0.0980178170208294) (0 0 0 3.0277915237471165 0.15769282036331483 -0.025522954028327223 0.07533179943931859 0.06482858366200249) (0 0 0 0 2.9080223493957265 0.07983627668197041 0.12320201734426509 -0.038918674767117606) (0 0 0 0 0 2.9254297526107824 0.15579388274275136 0.10954409370958469) (0 0 0 0 0 0 3.0637356229799124 0.08380997385073326) (0 0 0 0 0 0 0 3.06985314666063)) (-0.19960242556197227 0.17335879032213014 0.040748194300876485 0.014420968325299417 0.014753270835294967 0.02722716524905113 -0.21532119599618724 -0.02000377024487971))
    (-2.4829858808096215 1.1586145937897967 -1.9809189798007827 0.5176109997708597 0.041122990520034396 0.24881610019665987 -0.7911441607101299 0.28516545661664694)
)

; Test new p-sigma
! (assertEqual
    (new-step-size (step_size) (c_sigma) (d_sigma) (dim) (p_sigma))
    0.12224638563351164
)
